@inject NavigationManager Navigation
@inject IJSRuntime JS

@code {
    protected override void OnInitialized()
    {
        Navigation.LocationChanged += OnLocationChanged;
        TrackPage();
    }

    private async void OnLocationChanged(object? sender, LocationChangedEventArgs e)
    {
        await TrackPage();
    }

    private async Task TrackPage()
    {
        var uri = new Uri(Navigation.Uri);
        await JS.InvokeVoidAsync("trackPageView", uri.PathAndQuery);
    }

    public void Dispose()
    {
        Navigation.LocationChanged -= OnLocationChanged;
    }
}